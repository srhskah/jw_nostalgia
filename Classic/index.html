<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JW Classic</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DotGothic16&display=swap" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script>window.jQuery || document.write('<script src="/path/to/local/jquery.min.js"><\/script>')</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        body{
            margin: 0 auto;
            font-family: Unifont, DotGothic16;
            background: #cccccc;
        }
    </style>
</head>
<body>
    <div id="jw_classic" class="satu">
        <div id="title">
            <p id="title_text" style="float: left;margin-block-start: 0;">ğŸ–¼ï¸Image Viewer</p>
            <div class="btn">
                <!-- <div></div>
                <div></div> -->
                <div>Ã—</div>
            </div>
        </div>
        <div style="text-align: center;padding: 2.5%;">
            <img id="img-avatar" style="max-width: 100%;max-height: 30em;">
        </div>
        <div id="box" style="text-align: center;">
            <!-- Sarahah! -->
            <input id="chooseImage" type="file" name="file" accept="image/*">
            <button class="file-input-trigger" style="font-family: Unifont, DotGothic16;">é¸æŠåœ–ç‰‡</button>
            <!-- <input type="button" value=""> -->
        </div>

        <script>
            $("#chooseImage").on('change', function(){
                let file = this.files[0];
                if (file) {
                    let reader = new FileReader();
                    reader.onload = function(e) {
                        $('#img-avatar').attr('src', e.target.result);
                    };
                    reader.readAsDataURL(file);
                }
            });
            $('.file-input-trigger').on('click', function() {
                $('#chooseImage').trigger('click');
            });
        </script>
    </div>
    <div class="dua">
        <br>
        çª—å£æ ‡é¢˜&NonBreakingSpace;&NonBreakingSpace;
        <input type="text" id="textInput" oninput="updateP(this.value)">
        <br>
        <span style="font-size:0.625em">âš ï¸ è¾“å…¥æ–‡æœ¬åï¼Œçª—å£æ ‡é¢˜å°†è‡ªåŠ¨æ›´æ”¹ä¸ºæ–‡æœ¬æ¡†å†…å®¹</span>
        <!-- <p id="displayText">åˆå§‹å†…å®¹</p> -->
    
        <script>
            function updateP(newValue) {
                document.getElementById('title_text').textContent = newValue;
            }
        </script>
        <br><br>
        <div id="ctrls">
            å›¾ç‰‡é€æ˜åº¦&NonBreakingSpace;&NonBreakingSpace;
            <label>
                <input type="range" id="slider" min="0" max="1" step="0.01" value="1">
            </label>
            <label>
                <input type="number" id="input_num" min="0" max="1" step="0.01" value="1">
            </label>
        </div>
        <script>
            // è·å–å…ƒç´ 
            const target = document.getElementById('img-avatar');
            const slider = document.getElementById('slider');
            const input = document.getElementById('input_num');

            // æ»‘åŠ¨æ¡æ”¹å˜æ—¶æ›´æ–°é€æ˜åº¦å’Œè¾“å…¥æ¡†çš„å€¼
            slider.addEventListener('input', () => {
                const opacity = slider.value;
                target.style.opacity = opacity;
                input.value = opacity;
            });

            // è¾“å…¥æ¡†æ”¹å˜æ—¶æ›´æ–°é€æ˜åº¦å’Œæ»‘åŠ¨æ¡çš„å€¼
            input.addEventListener('input', () => {
                const opacity = input.value;
                target.style.opacity = opacity;
                slider.value = opacity;
            });
        </script>
        <br>
        <div id="ctrls_2">
            é¢œè‰²
            <br>
            R
            <label>
                <input type="range" id="slider_r" min="0" max="255" step="1" value="0">
            </label>
            <label>
                <input type="number" id="input_r" min="0" max="255" step="1" value="0">
            </label>
            <br>
            <!-- &NonBreakingSpace;&NonBreakingSpace;&NonBreakingSpace;&NonBreakingSpace; -->
            G
            <label>
                <input type="range" id="slider_g" min="0" max="255" step="1" value="0">
            </label>
            <label>
                <input type="number" id="input_g" min="0" max="255" step="1" value="0">
            </label>
            <br>
            <!-- &NonBreakingSpace;&NonBreakingSpace;&NonBreakingSpace;&NonBreakingSpace; -->
            B
            <label>
                <input type="range" id="slider_b" min="0" max="255" step="1" value="192">
            </label>
            <label>
                <input type="number" id="input_b" min="0" max="255" step="1" value="192">
            </label>
            <br>
            <!-- &NonBreakingSpace;&NonBreakingSpace;&NonBreakingSpace;&NonBreakingSpace; -->
        </div>
        <script>
            const trg = document.getElementById('title');
            const redSlider = document.getElementById('slider_r');
            const greenSlider = document.getElementById('slider_g');
            const blueSlider = document.getElementById('slider_b');
            const redValue = document.getElementById('input_r');
            const greenValue = document.getElementById('input_g');
            const blueValue = document.getElementById('input_b');

            // æ›´æ–°èƒŒæ™¯é¢œè‰²
            function updateBackgroundColor() {
                const red = redSlider.value;
                const green = greenSlider.value;
                const blue = blueSlider.value;

                // è®¾ç½®ç›®æ ‡æ§ä»¶çš„èƒŒæ™¯é¢œè‰²
                trg.style.backgroundColor = `rgba(${red}, ${green}, ${blue})`;

                // æ›´æ–°æ˜¾ç¤ºçš„å€¼
                redValue.value = red;
                greenValue.value = green;
                blueValue.value = blue;
            }

            // æ›´æ–°èƒŒæ™¯é¢œè‰²
            function updateBackgroundColor_2() {
                const red = redValue.value;
                const green = greenValue.value;
                const blue = blueValue.value;

                // è®¾ç½®ç›®æ ‡æ§ä»¶çš„èƒŒæ™¯é¢œè‰²
                trg.style.backgroundColor = `rgba(${red}, ${green}, ${blue})`;

                // æ›´æ–°æ˜¾ç¤ºçš„å€¼
                redSlider.value = red;
                greenSlider.value = green;
                blueSlider.value = blue;
            }


            // ç›‘å¬æ»‘åŠ¨æ¡çš„å˜åŒ–
            redSlider.addEventListener('input', updateBackgroundColor);
            greenSlider.addEventListener('input', updateBackgroundColor);
            blueSlider.addEventListener('input', updateBackgroundColor);
            

            redValue.addEventListener('input', updateBackgroundColor_2);
            greenValue.addEventListener('input', updateBackgroundColor_2);
            blueValue.addEventListener('input', updateBackgroundColor_2);
            
            // åˆå§‹åŒ–
            updateBackgroundColor();
            updateBackgroundColor_2();
        </script>
        <br>
        <button id="exportButton">å¯¼å‡ºå¯¹è¯æ¡†ä¸ºå›¾ç‰‡</button>
        <script>
            document.getElementById('exportButton').addEventListener('click', function() {
                var element = document.getElementById('jw_classic'); // è·å–ä½ æƒ³è¦å¯¼å‡ºçš„ <div> çš„ ID
                html2canvas(element,{scale:3}).then(function(canvas) {
                    // å°† canvas è½¬æ¢ä¸ºå›¾ç‰‡ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªä¸‹è½½é“¾æ¥
                    var imgData = canvas.toDataURL('image/png');
                    var link = document.createElement('a');
                    link.href = imgData;
                    link.download = 'exported-image.png'; // è®¾ç½®æ–‡ä»¶å
                    link.click();
                });
            });
        </script>
        <br><br>
        <a href="../Aero/index.html">JW Aero (Win7-like)</a>
    </div>
</body>
</html>